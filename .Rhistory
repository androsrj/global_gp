cov.matrix <- cov(margins)
lambda <- 0.2
target <- matrix(0.3, 7, 7)
diag(target) <- 1
shrunk.cov <- lambda * target + (1 - lambda) * cov.matrix
shrunk.cov
cor.matrix <- cor(margins)
target <- matrix(0.3, 7, 7)
diag(target) <- 1
shrunk.cor <- lambda * target + (1 - lambda) * cor.matrix
shrunk.cor
round(cor(margins), 2)
lambda <- 0.5
cor.matrix <- cor(margins)
target <- matrix(0.5, 7, 7)
diag(target) <- 1
shrunk.cor <- lambda * target + (1 - lambda) * cor.matrix
shrunk.cor
Sigma <- cov(margins)
Sigma[Sigma < 0] <- 0.1
mu <- rep(0, 7)
nReps <- 1000000
sim <- rmvnorm(n = nReps, mean = mu, sigma = Sigma)
wins <- sim > 0
outcomes <- apply(wins, 1, paste0, collapse = "")
props <- table(outcomes) / nReps
combos <- names(props)
length(props)
Sigma <- cov(margins)
Sigma[Sigma < 0] <- 0
mu <- rep(0, 7)
nReps <- 1000000
sim <- rmvnorm(n = nReps, mean = mu, sigma = Sigma)
?rmultinom
rmultinom(1, 5)
rmultinom(1, 5, c(0.3, 0.2, 0.5))
n.sims <- 100
my.samples <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
my.samples[i,] <- rmultinom(1,5,c(0.3,0.5,0.2))}
mean(my.samples[,2])
dim(my.samples)
head(my.samples)
rowSums(my.samples)
dim(rmultinom(100, 5, c(0.3, 0.5, 0.2)))
dpois(5, 6)
ppois(3, 6)
dbinom(6, 9, .7)
1-pbinom(3, 9, .7)
dmultinom(c(5, 4, 1, 0), 10, c(.44, .42, .10, .04))
m <- rmultinom(10000, 100, c(.25, .35, .4))
colMeans(m)
rowMeans(m)
hist(m[1,])
mean(m[1,] < 20)
m <- rmultinom(10000, 100, c(.25, .35, .4))
mean(m[1,] < 20)
m <- rmultinom(10000, 100, c(.25, .35, .4))
mean(m[1,] < 20)
m <- rmultinom(10000, 100, c(.25, .35, .4))
mean(m[1,] < 20)
m <- rmultinom(10000, 100, c(.25, .35, .4))
mean(m[1,] < 20)
pbinom(19, 100, .25)
mean(m[2,] < m[3,])
?rpois
dpois(6, 8)
# Find the probability that X = 9
dpois(9, 6)
# Find the probability that X = 9
dpois(9, 8)
# Find the probability that X = 7 OR X = 8
dpois(7, 8) + dpois(8, 8)
ppois(18, 20)
# Find the probability that X is less than or equal to 2?
ppois(2, 20)
# Find the probability that X is greater than 16?
1 - ppois(15, 20)
# Find the probability that X is at least 22?
1 - ppois(21, 20)
# Find the probability that X is between 15 and 19 (inclusive)?
ppois(19, 20) - ppois(14, 20)
# Rpois - used to draw random sample(s) from a Poisson distribution
# Generate 3 samples from a Poisson distribution with mean 5
rpois(3, 5)
rpois(3, 5)
rpois(3, 5)
rpois(3, 5)
rpois(3, 5)
rpois(3, 5)
rpois(3, 5)
dbinom(4, 15, 0.25)
dbinom(4, 15, 0.25)
dbinom(4, 15, 0.25)
dbinom(4, 15, 0.25)
# Find probability that X is 9?
dbinom(9, 15, 0.25)
# Find probability that X is between 3 and 7 (inclusive)?
pbinom(7, 15, 0.25) - pbinom(2, 15, 0.25)
dbinom(3, 15, 0.25) + dbinom(4, 15, 0.25) + dbinom(5, 15, 0.25) + dbinom(6, 15, 0.25) + dibom(7, 15, 0.25)
dbinom(3, 15, 0.25) + dbinom(4, 15, 0.25) + dbinom(5, 15, 0.25) + dbinom(6, 15, 0.25) + dbinom(7, 15, 0.25)
# Draw 10 random samples from a binomial distribution with n = 100 and p = 0.44
rbinom(10, 100, 0.44)
.44*100
?dmultinom
# Multinomial
# Example: We have a bag with thousands of marbles and are drawing 10 of them
# The bag contains 20% red, 42% green, and 38% yellow marbles
# Find the probability that we draw exactly 2 red, 4 green, and 4 yellow
dmultinom(x = c(2, 4, 4),
size = 10,
prob = c(0.20, 0.42, 0.38))
dmultinom(x = c(4, 2, 4),
size = 10,
prob = c(0.42, 0.20, 0.38))
# Simulate 20 experiments from this scenario
# (in each experiment, we're randomly selecting 10 marbles)
rmultinom(20, 10, prob = c(0.20, 0.42, 0.38))
dmultinom(x = c(2, 4, 4),
size = 10,
prob = c(0.20, 0.42, 0.38))
rmultinom(20, 10, prob = c(0.20, 0.42, 0.38))
n.sims <- 100
my.samples <- matrix(NA,n.sims,3)
View(my.samples)
i=1
my.samples[i,] <- rmultinom(1,5,c(0.3,0.5,0.2))
i=2
my.samples[i,] <- rmultinom(1,5,c(0.3,0.5,0.2))
n.sims <- 100
my.samples <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
my.samples[i,] <- rmultinom(1,5,c(0.3,0.5,0.2))
}
n.sims <- 100
my.samples <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
my.samples[i,] <- rmultinom(1,5,c(0.3,0.5,0.2))
}
mean(my.samples[,2])
n.sims <- 100
my.samples <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
my.samples[i,] <- rmultinom(1,5,c(0.3,0.5,0.2))
}
mean(my.samples[,2])
n.sims <- 100
my.samples <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
my.samples[i,] <- rmultinom(1,5,c(0.3,0.5,0.2))
}
mean(my.samples[,2])
n.sims <- 100
my.samples <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
my.samples[i,] <- rmultinom(1,5,c(0.3,0.5,0.2))
}
mean(my.samples[,2])
n.sims <- 100
my.samples <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
my.samples[i,] <- rmultinom(1,5,c(0.3,0.5,0.2))
}
mean(my.samples[,2])
n.sims <- 100
my.samples <- rmultinom(n.sims, 5, c(0.3,0.5,0.2))
n.sims <- 100
my.samples <- rmultinom(n.sims, 5, c(0.3,0.5,0.2))
mean(my.samples[2,])
n.sims <- 100
my.samples <- rmultinom(n.sims, 5, c(0.3,0.5,0.2))
mean(my.samples[2,])
n.sims <- 100
my.samples <- rmultinom(n.sims, 5, c(0.3,0.5,0.2))
mean(my.samples[2,])
n.sims <- 100
my.samples <- rmultinom(n.sims, 5, c(0.3,0.5,0.2))
mean(my.samples[2,])
n.sims <- 100
my.samples <- rmultinom(n.sims, 5, c(0.3,0.5,0.2))
mean(my.samples[2,])
n.sims <- 100
my.samples <- rmultinom(n.sims, 5, c(0.3,0.5,0.2))
mean(my.samples[2,])
n.sims <- 100
my.samples <- rmultinom(n.sims, 5, c(0.3,0.5,0.2))
mean(my.samples[2,])
n.sims <- 100
my.samples <- rmultinom(n.sims, 5, c(0.3,0.5,0.2))
mean(my.samples[2,])
n.sims <- 100
my.samples <- rmultinom(n.sims, 5, c(0.3,0.5,0.2))
mean(my.samples[2,])
# Simulation from HW Q15
n.sims <- 10000
patients <- rmultinom(n.sims, 100, c(0.25, 0.35, 0.40))
# Simulation from HW Q15
n.sims <- 10000
patients <- rmultinom(n.sims, 100, c(0.25, 0.35, 0.40))
patients[ , 1:10]
patients[1,]
patients[1,] < 20
mean(patients[1,] < 20)
pbinom(19, 100, .25)
a=5
satellites <- c(8, 0, 9, 0, 4, 0, 0, 0, 0, 0, 0, 0, 11, 0, 14, 8, 1, 1, 0, 5,
4, 3, 1, 2, 3, 0, 3, 5, 0, 0, 4, 0, 0, 0, 8, 5, 0, 0, 6, 0, 6,
3, 5, 6, 3, 6, 5, 6, 5, 9, 4, 6, 15, 3, 3, 3, 0, 0, 5, 0, 0, 5,
0, 0, 4, 0, 0, 3, 4, 0, 5, 0, 0, 0, 0, 0, 5, 0, 0, 0, 0, 0, 5,
0, 0, 0, 0, 0, 0, 0, 0)
# Define the Poisson log likelihood function
poisson_log_likelihood <- function(lambda, data) {
sum(dpois(data, lambda, log = TRUE))
}
# Generate lambda sequence from 1 to 5 by 0.1
lambdas <- seq(1, 5, by = 0.1)
# Calculate log likelihood for each lambda value
log_likelihoods <- sapply(lambdas, poisson_log_likelihood, data = satellites)
# Plot results
plot(lambdas, log_likelihoods, type = "o", pch = 16,
xlab = expression(lambda),
ylab = "Log Likelihood",
main = "Log Likelihood vs Lambda for Poisson Distribution")
grid()
# Plot results
plot(lambdas, log_likelihoods, type = "o", pch = 16,
xlab = expression(lambda),
ylab = "Log Likelihood",
main = "Log Likelihood vs Lambda for Poisson Distribution")
n <- 1000
phi <- matrix(rnorm(n^2, 0, sqrt(1/n)), nrow = n, ncol = n)
sigma <- phi %*% diag(n) %*% t(phi)
dim(sigma)
n <- 1000
m <- 50
phi <- matrix(rnorm(n*m, 0, sqrt(1/n)), nrow = m, ncol = n)
sigma <- phi %*% diag(n) %*% t(phi)
dim(sigma)
sigma
?t.test
t.test(rnorm(10),rnorm(10),alternate="greater")
setwd("C:/Users/andro/Downloads/312_hw10")
cancer <- read.csv("cancer.csv")
View(cancer)
table(cancer$BMIGroup)
anova(data = cancer, Adiponectin ~ BMIGroup)
?anova
anova(lm*data = cancer, Adiponectin ~ BMIGroup))
anova(lm(data = cancer, Adiponectin ~ BMIGroup))
?aov
aov(data = cancer, Adiponectin ~ BMIGroup)
cancer.anova <- aov(data = cancer, Adiponectin ~ BMIGroup)
summary(cancer.anova)
anova(lm(data = cancer, Adiponectin ~ BMIGroup))
boxplot(data = cancer, Adiponectin ~ BMIGroup)
?TukeyHSD
TukeyHSD(cancer.anova)
# Regression
cancer.lm <- lm(data = cancer, HOMA ~ Leptin)
summaru(cancer.lm)
summary(cancer.lm)
predict(cancer.lm, newdata = data.frame(Leptin =  8.8438))
predict(cancer.lm, newdata = c(Leptin =  8.8438))
new.pred <- predict(cancer.lm, newdata = data.frame(Leptin =  8.8438))
new.pred
0.7068973 - new.pred
plot(cancer.lm)
# Transformed regression
log.lm <- lm(data = cancer, HOMA ~ log(Leptin))
hist(cancer.lm$residuals, xlab = "Residuals", main = "Histogram of Residuals")
hist(cancer.lm$residuals, xlab = "Residuals", main = "Histogram of Residuals", breaks = 10)
plot(cancer$Leptin, cancer.lm$residuals, ylab = "Residuals", xlab = "Leptin", main = "Residual Plot")
abline(h=0)
# Transformed regression
log.lm <- lm(data = cancer, HOMA ~ log(Leptin))
summary(log.lm)
# Check assumptions
hist(log.lm$residuals, xlab = "Residuals", main = "Histogram of Residuals", breaks = 10)
plot(log(cancer$Leptin), log.lm$residuals, ylab = "Residuals", xlab = "Log-Leptin", main = "Residual Plot")
abline(h=0)
plot(cancer$Leptin, log.lm$residuals, ylab = "Residuals", xlab = "Log-Leptin", main = "Residual Plot")
# Transformed regression
log.lm <- lm(data = cancer, HOMA ~ log(Leptin))
summary(log.lm)
# Check assumptions
hist(log.lm$residuals, xlab = "Residuals", main = "Histogram of Residuals", breaks = 10)
plot(log(cancer$Leptin), log.lm$residuals, ylab = "Residuals", xlab = "Log-Leptin", main = "Residual Plot")
abline(h=0)
plot(log.lm)
plot(log.lm)
summary(cancer.lm)
summary(log.lm)
# Transformed regression
log.lm <- lm(data = cancer, log(HOMA) ~ log(Leptin))
summary(log.lm)
# Check assumptions
hist(log.lm$residuals, xlab = "Residuals", main = "Histogram of Residuals", breaks = 10)
plot(log(cancer$Leptin), log.lm$residuals, ylab = "Residuals", xlab = "Log-Leptin", main = "Residual Plot")
setwd("C:/Users/andro/Downloads")
summary(cancer.anova)
boxplot(data = cancer, Adiponectin ~ BMIGroup)
TukeyHSD(cancer.anova)
# Regression
cancer.lm <- lm(data = cancer, HOMA ~ Leptin)
summary(cancer.lm)
plot(data = cancer, HOMA ~ Leptin)
plot(diabetes$glutest,diabetes$insulin,main="Scatterplot of Glucose Test vs. Insulin Test",xlab="Glucose Test",ylab="Insulin Test")
setwd("~/research/global_gp/generate_data")
source("../other_functions/spatial_data_scen13.R")
source("../other_functions/bsplines_2_3D.R")
mySeed <- 45298
# Sample sizes
# Can have a "small" dataset with n = 100 and nTest = 25
# Then a "large" dataset with n = 500 and nTest = 100
n <- 100
nTest <- 100
# Number of subjects - can probably leave these alone
S <- 10
STest <- 10
# Number of predictors
K <- 9
p <- 2
# Covariance parameters for beta
trueSigb2 <- seq(0.5, 1.0, length = p + 1)
trueThb <- seq(0.1, 0.2, length = p + 1)
# Covariance parameters for global covariates (each length K)
trueSigma2 <- seq(5, 10, length = K)
trueTheta <- seq(0.1, 0.5, length = K)
# Error variance
trueTau2 <- 2
# Beta
trueBeta <- rep(0, p+1)
##########################
# Generate training data #
set.seed(mySeed)
X <- matrix(runif(n*p, 0, 10), nrow = n, ncol = p)
Z <- matrix(runif(2 * S, 0, 100), ncol = 2)
train <- spatialData(n = n,
X = X,
Z = Z,
K = K,
sigb2 = trueSigb2,
thb = trueThb,
sigma2 = trueSigma2,
theta = trueTheta,
tau2 = trueTau2,
beta = trueBeta,
range = c(0, 100))
warnings()
sigb2 = trueSigb2
thb = trueThb
sigma2 = trueSigma2
theta = trueTheta
tau2 = trueTau2
beta = trueBeta
range = c(0, 100)
locations <- runif(n * dims, range[1], range[2])
U <- matrix(locations, nrow = n, ncol = dims)
dims = 2
range=c(0,10)
range = c(0, 100)
locations <- runif(n * dims, range[1], range[2])
U <- matrix(locations, nrow = n, ncol = dims)
# Order U by sum of coordinates
U <- U[order(rowSums(U)), ]
D <- rdist(U)
C <- lapply(1:K, function(k) {
sigma2[k] * (1 + sqrt(3) * theta * D) * exp(-sqrt(3) * theta[k] * D)
})
k=1
sigma2[k]
dim(1 + sqrt(3) * theta * D)
source("../other_functions/spatial_data_scen13.R")
source("../other_functions/bsplines_2_3D.R")
mySeed <- 45298
# Sample sizes
# Can have a "small" dataset with n = 100 and nTest = 25
# Then a "large" dataset with n = 500 and nTest = 100
n <- 100
nTest <- 100
# Number of subjects - can probably leave these alone
S <- 10
STest <- 10
# Number of predictors
K <- 9
p <- 2
### True parameter values ###
# Need to play around with these
# Covariance parameters for beta
trueSigb2 <- seq(0.5, 1.0, length = p + 1)
trueThb <- seq(0.1, 0.2, length = p + 1)
# Covariance parameters for global covariates (each length K)
trueSigma2 <- seq(5, 10, length = K)
trueTheta <- seq(0.1, 0.5, length = K)
# Error variance
trueTau2 <- 2
# Beta
trueBeta <- rep(0, p+1)
##########################
# Generate training data #
set.seed(mySeed)
X <- matrix(runif(n*p, 0, 10), nrow = n, ncol = p)
Z <- matrix(runif(2 * S, 0, 100), ncol = 2)
train <- spatialData(n = n,
X = X,
Z = Z,
K = K,
sigb2 = trueSigb2,
thb = trueThb,
sigma2 = trueSigma2,
theta = trueTheta,
tau2 = trueTau2,
beta = trueBeta,
range = c(0, 100))
saveRDS(train, file = "../data/small/scen13/train.RDS")
sd(train$Y)
set.seed(mySeed)
indexTest <- sample(n, nTest)
U <- train$U[indexTest, ]
# Generate testing data
set.seed(mySeed + 1)
XTest <- matrix(runif(nTest*p, 0, 10), nrow = nTest, ncol = p)
ZTest <- matrix(runif(2 * STest, 0, 100), ncol = 2)
test <- spatialData(n = nTest,
X = XTest,
Z = ZTest,
U = U,
K = K,
sigb2 = trueSigb2,
thb = trueThb,
sigma2 = trueSigma2,
theta = trueTheta,
tau2 = trueTau2,
beta = trueBeta,
range = c(0, 100))
test$index <- indexTest
saveRDS(test, file = "../data/small/scen13/test.RDS")
sd(test$Y)
setwd("~/research/global_gp")
library(MBA)
library(splines)
library(fields)
library(parallel)
library(doParallel)
library(foreach)
library(Matrix)
nReps <- nCores <- 10
set.seed(9994)
which.scens <- 13
run.mcmc <- function(rep) {
results <- mcmc(X = X, Z = Z, Y = Y, D = D, K = K,
starting = starting,
propSD = propSD,
nIter = 5000, nBurn = 2000, nThin=2,
model = "full_gp")
return(results)
}
results <- mcmc(X = X, Z = Z, Y = Y, D = D, K = K,
starting = starting,
propSD = propSD,
nIter = 50, nBurn = 20, nThin=2,
model = "full_gp")
run.mcmc <- function(rep) {
results <- mcmc(X = X, Z = Z, Y = Y, D = D, K = K,
starting = starting,
propSD = propSD,
nIter = 50, nBurn = 20, nThin=2,
model = "full_gp")
return(results)
}
##### SCENARIO 13 #####
scen <- 13
source("mcmc_functions/smooth/mcmc_smooth.R") # Metropolis-Gibbs Sampler
source("mcmc_functions/priors.R")
source("mcmc_functions/jacobians.R")
source("mcmc_functions/likelihood.R")
source("mcmc_functions/smooth/posterior.R")
source("mcmc_functions/smooth/helper_functions.R") # Other misc functions (not part of MCMC)
source("other_functions/bsplines_2_3D.R")
dir <- paste0("data/small/scen", scen, "/")
train <- readRDS(paste0(dir, "train.RDS"))
test <- readRDS(paste0(dir, "test.RDS"))
n <- nrow(train$X)
nTest <- nrow(test$X)
X <- train$X; XTest <- test$X
Z <- train$Z; ZTest <- test$Z
Y <- train$Y; YTest <- test$Y
U <- train$U; UTest <- test$U
D <- train$D; DTest <- test$D
K <- 9
q <- ncol(X) + 1
propSD <- list(sigma2 = seq(0.6, 0.8, length = K),
theta = seq(1.5, 2.0, length = K),
sigb2 = seq(0.3, 0.4, length = q),
thb = seq(0.01, 0.1, length = q),
tau2 = 0.3)
starting <- list(sigma2 = rep(50, K),
theta = rep(.25, K),
sigb2 = rep(0.2, q),
thb = rep(0.2, q),
tau2 = 1)
#cl <- makeCluster(nCores)
#registerDoParallel(cl)
#obj <- foreach(i = 1:nCores, .packages = c("mvtnorm", "splines", "fields", "Matrix")) %dopar% run.mcmc(i)
#stopCluster(cl)
obj <- run.mcmc(1)
obj$acceptance
?pca
?prcomp
prcomp(mtcars)
eigen(mtcars)
2278
