my.samples <- rmultinom(100, 5, c(0.3, 0.5, 0.2))
mean(my.samples[2, ])
my.samples <- rmultinom(100, 5, c(0.3, 0.5, 0.2))
mean(my.samples[2, ])
sims <- rmultinom(10000, size = 100, prob = c(0.25, 0.35, 0.40))
treatmentA_counts <- sims[1, ]
prob_estimate <- mean(treatmentA_counts < 20)
prob_estimate
prob_placebo_more_B <- mean(placebo > treatmentB)
n.sims <- 100
my.samples <- rmultinom(n.sims, 5, c(0.3, 0.5, 0.2))
mean(my.samples[2,])
n.sims <- 100
my.samples <- rmultinom(n.sims, 5, c(0.3, 0.5, 0.2))
mean(my.samples[2,])
n.sims <- 100
my.samples <- rmultinom(n.sims, 5, c(0.3, 0.5, 0.2))
mean(my.samples[2,])
n.sims <- 100
my.samples <- rmultinom(n.sims, 5, c(0.3, 0.5, 0.2))
mean(my.samples[2,])
n.sims <- 10000
samples <- rmultinom(n.sims,100,c(0.25, 0.35, 0.40))
mean(samples[1,] < 20)
n.sims <- 10000
samples <- rmultinom(n.sims,100,c(0.25, 0.35, 0.40))
mean(samples[1,] < 20)
n.sims <- 10000
samples <- rmultinom(n.sims,100,c(0.25, 0.35, 0.40))
mean(samples[1,] < 20)
n.sims <- 10000
samples <- rmultinom(n.sims,100,c(0.25, 0.35, 0.40))
mean(samples[1,] < 20)
n.sims <- 10000
samples <- rmultinom(n.sims,100,c(0.25, 0.35, 0.40))
mean(samples[1,] < 20)
n.sims <- 10000
samples <- rmultinom(n.sims, 100, c(0.25, 0.35, 0.40))
mean(samples[3,] > samples[2,])
n.sims <- 10000
samples <- rmultinom(n.sims, 100, c(0.25, 0.35, 0.40))
mean(samples[3,] > samples[2,])
n.sims <- 10000
samples <- rmultinom(n.sims, 100, c(0.25, 0.35, 0.40))
mean(samples[3,] > samples[2,])
n.sims <- 10000
treatmentA <- rbinom(n.sims, 100, 0.25)
mean(treatmentA < 20)
n.sims <- 10000
treatmentA <- rbinom(n.sims, 100, 0.25)
mean(treatmentA < 20)
n.sims <- 10000
treatmentA <- rbinom(n.sims, 100, 0.25)
mean(treatmentA < 20)
n.sims <- 10000
treatmentA <- rbinom(n.sims, 100, 0.25)
mean(treatmentA < 20)
n.sims <- 10000
treatmentA <- rbinom(n.sims, 100, 0.25)
mean(treatmentA < 20)
n.sims <- 10000
treatmentA <- rbinom(n.sims, 100, 0.25)
mean(treatmentA < 20)
n.sims <- 10000
treatmentA <- rbinom(n.sims, 100, 0.25)
mean(treatmentA < 20)
n.sims <- 10000
treatmentA <- rbinom(n.sims, 100, 0.25)
mean(treatmentA < 20)
n.sims <- 10000
assignment <- rmultinom(n.sims, 100, c(0.25, 0.35, 0.40))
treatmentB <- assignment[2, ]
placebo    <- assignment[3, ]
mean(placebo > treatmentB)
n.sims <- 10000
assignment <- rmultinom(n.sims, 100, c(0.25, 0.35, 0.40))
treatmentB <- assignment[2, ]
placebo    <- assignment[3, ]
mean(placebo > treatmentB)
n.sims <- 10000
assignment <- rmultinom(n.sims, 100, c(0.25, 0.35, 0.40))
treatmentB <- assignment[2, ]
placebo    <- assignment[3, ]
mean(placebo > treatmentB)
n.sims <- 10000
assignment <- rmultinom(n.sims, 100, c(0.25, 0.35, 0.40))
treatmentB <- assignment[2, ]
placebo    <- assignment[3, ]
mean(placebo > treatmentB)
n.sims <- 10000
assignment <- rmultinom(n.sims, 100, c(0.25, 0.35, 0.40))
treatmentB <- assignment[2, ]
placebo    <- assignment[3, ]
mean(placebo > treatmentB)
n.sims <- 10000
new.data <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
new.data[i,] <- rmultinom(1,100,c(0.25,0.35,0.40)) }
mean(new.data [,1]<20)
n.sims <- 10000
new.data <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
new.data[i,] <- rmultinom(1,100,c(0.25,0.35,0.40)) }
mean(new.data [,1]<20)
n.sims <- 10000
new.data <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
new.data[i,] <- rmultinom(1,100,c(0.25,0.35,0.40)) }
mean(new.data [,1]<20)
n.sims <- 10000
new.data <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
new.data[i,] <- rmultinom(1,100,c(0.25,0.35,0.40)) }
mean(new.data [,1]<20)
n.sims <- 10000
new.data <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
new.data[i,] <- rmultinom(1,100,c(0.25,0.35,0.40)) }
mean(new.data [,1]<20)
n.sims <- 10000
new.data <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
new.data[i,] <- rmultinom(1,100,c(0.25,0.35,0.40)) }
mean(new.data [,3]> new.data[,2])
n.sims <- 10000
new.data <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
new.data[i,] <- rmultinom(1,100,c(0.25,0.35,0.40)) }
mean(new.data [,3]> new.data[,2])
n.sims <- 10000
new.data <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
new.data[i,] <- rmultinom(1,100,c(0.25,0.35,0.40)) }
mean(new.data [,3]> new.data[,2])
n.sims <- 10000
new.data <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
new.data[i,] <- rmultinom(1,100,c(0.25,0.35,0.40)) }
mean(new.data [,3]> new.data[,2])
mean(t(rmultinom(n.sims, 5,  c(0.3, 0.5, 0.2)))[, 2]
)
n_samples<- 10000
n_patients<- 100
probs<- c(0.25, 0.35, 0.40)
results<- rmultinom(n_samples, size = n_patients, prob=probs)
tretment_a_patients<- results[1,]
less_than_20<- sum(tretment_a_patients<20)
estimated_probability<- less_than_20/n_samples
print(estimated_probability)
n_samples<- 10000
n_patients<- 100
probs<- c(0.25, 0.35, 0.40)
results<- rmultinom(n_samples, size = n_patients, prob=probs)
tretment_a_patients<- results[1,]
less_than_20<- sum(tretment_a_patients<20)
estimated_probability<- less_than_20/n_samples
print(estimated_probability)
n_samples<- 10000
n_patients<- 100
probs<- c(0.25, 0.35, 0.40)
results<- rmultinom(n_samples, size = n_patients, prob=probs)
tretment_a_patients<- results[1,]
less_than_20<- sum(tretment_a_patients<20)
estimated_probability<- less_than_20/n_samples
print(estimated_probability)
n_samples<- 10000
n_patients<- 100
probs<- c(0.25, 0.35, 0.40)
results<- rmultinom(n_samples, size = n_patients, prob=probs)
tretment_a_patients<- results[1,]
less_than_20<- sum(tretment_a_patients<20)
estimated_probability<- less_than_20/n_samples
print(estimated_probability)
n_samples<- 10000
n_patients<- 100
probs<- c(0.25, 0.35, 0.40)
results<- rmultinom(n_samples, size = n_patients, prob=probs)
tretment_a_patients<- results[1,]
less_than_20<- sum(tretment_a_patients<20)
estimated_probability<- less_than_20/n_samples
print(estimated_probability)
n_samples<- 10000
n_patients<- 100
probs<- c(0.25, 0.35, 0.40)
results<- rmultinom(n_samples, size = n_patients, prob=probs)
tretment_a_patients<- results[1,]
less_than_20<- sum(tretment_a_patients<20)
estimated_probability<- less_than_20/n_samples
print(estimated_probability)
n_sims <- 10000
results <- rmultinom(n_sims, 100, c(0.25, 0.35, 0.4))
treatment_b_counts <- results[2, ]
placebo_counts <- results[3, ]
probability_estimate <- mean(placebo_counts > treatment_b_counts)
round(probability_estimate, 2)
n_sims <- 10000
results <- rmultinom(n_sims, 100, c(0.25, 0.35, 0.4))
treatment_b_counts <- results[2, ]
placebo_counts <- results[3, ]
probability_estimate <- mean(placebo_counts > treatment_b_counts)
round(probability_estimate, 2)
n_sims <- 10000
results <- rmultinom(n_sims, 100, c(0.25, 0.35, 0.4))
treatment_b_counts <- results[2, ]
placebo_counts <- results[3, ]
probability_estimate <- mean(placebo_counts > treatment_b_counts)
round(probability_estimate, 2)
n_sims <- 10000
results <- rmultinom(n_sims, 100, c(0.25, 0.35, 0.4))
treatment_b_counts <- results[2, ]
placebo_counts <- results[3, ]
probability_estimate <- mean(placebo_counts > treatment_b_counts)
round(probability_estimate, 2)
n_sims <- 10000
results <- rmultinom(n_sims, 100, c(0.25, 0.35, 0.4))
treatment_b_counts <- results[2, ]
placebo_counts <- results[3, ]
probability_estimate <- mean(placebo_counts > treatment_b_counts)
round(probability_estimate, 2)
mean(rmultinom(100, 5, c(0.3, 0.5, 0.2))[2, ])
mean(rmultinom(100, 5, c(0.3, 0.5, 0.2))[2, ])
mean(rmultinom(100, 5, c(0.3, 0.5, 0.2))[2, ])
treatment.probs <- c(0.25,0.35,0.4)
n_patients <- 100
n.sims <- 10000
results <- rmultinom(n.sims, n_patients, treatment.probs)
(sum(results[1,] < 20))/n.sims
treatment.probs <- c(0.25,0.35,0.4)
n_patients <- 100
n.sims <- 10000
results <- rmultinom(n.sims, n_patients, treatment.probs)
(sum(results[1,] < 20))/n.sims
treatment.probs <- c(0.25,0.35,0.4)
n_patients <- 100
n.sims <- 10000
results <- rmultinom(n.sims, n_patients, treatment.probs)
(sum(results[1,] < 20))/n.sims
treatment.probs <- c(0.25,0.35,0.4)
n_patients <- 100
n.sims <- 10000
results <- rmultinom(n.sims, n_patients, treatment.probs)
(sum(results[1,] < 20))/n.sims
treatment.probs <- c(0.25,0.35,0.4)
n_patients <- 100
n.sims <- 10000
results <- rmultinom(n.sims, n_patients, treatment.probs)
(sum(results[3,] > results[2,]))/n.sims
treatment.probs <- c(0.25,0.35,0.4)
n_patients <- 100
n.sims <- 10000
results <- rmultinom(n.sims, n_patients, treatment.probs)
(sum(results[3,] > results[2,]))/n.sims
treatment.probs <- c(0.25,0.35,0.4)
n_patients <- 100
n.sims <- 10000
results <- rmultinom(n.sims, n_patients, treatment.probs)
(sum(results[3,] > results[2,]))/n.sims
n.sims<- 10000
prob<- c(.25,.35,.4)
samples<- rmultinom(n.sims, n.patients, prob)
n.patients=100
n.sims<- 10000
prob<- c(.25,.35,.4)
samples<- rmultinom(n.sims, n.patients, prob)
mean(samples[1,] < 20)
n.patients=100
n.sims<- 10000
prob<- c(.25,.35,.4)
samples<- rmultinom(n.sims, n.patients, prob)
mean(samples[1,] < 20)
n.patients=100
n.sims<- 10000
prob<- c(.25,.35,.4)
samples<- rmultinom(n.sims, n.patients, prob)
mean(samples[1,] < 20)
n.patients=100
n.sims<- 10000
prob<- c(.25,.35,.4)
samples<- rmultinom(n.sims, n.patients, prob)
mean(samples[1,] < 20)
n.sims<- 10000
prob<- c(.25,.35,.4)
samples<- rmultinom(n.sims, n.patients, prob)
mean(samples[3,]>samples[2,])
n.sims<- 10000
prob<- c(.25,.35,.4)
samples<- rmultinom(n.sims, n.patients, prob)
mean(samples[3,]>samples[2,])
my.samples<-rmultinom(100,5,c(0.3,0.5,0.2))
mean(my.samples[,2])
my.samples<-rmultinom(100,5,c(0.3,0.5,0.2))
mean(my.samples[,2])
my.samples<-rmultinom(100,5,c(0.3,0.5,0.2))
mean(my.samples[,2])
my.samples<-rmultinom(100,5,c(0.3,0.5,0.2))
mean(my.samples[,2])
my.samples<-rmultinom(100,5,c(0.3,0.5,0.2))
mean(my.samples[2,])
my.samples<-rmultinom(100,5,c(0.3,0.5,0.2))
mean(my.samples[2,])
my.samples<-rmultinom(100,5,c(0.3,0.5,0.2))
mean(my.samples[2,])
n.sims <- 10000
my.samples <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
my.samples[i,] <- rmultinom(1,100,c(0.25,0.35,0.4))}
prob <- mean(my.samples[,1]<20)
prob
n.sims <- 10000
my.samples <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
my.samples[i,] <- rmultinom(1,100,c(0.25,0.35,0.4))}
prob <- mean(my.samples[,1]<20)
prob
n.sims <- 10000
my.samples <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
my.samples[i,] <- rmultinom(1,100,c(0.25,0.35,0.4))}
prob <- mean(my.samples[,1]<20)
prob
n.sims <- 10000
my.samples <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
my.samples[i,] <- rmultinom(1,100,c(0.25,0.35,0.4))}
prob <- mean(my.samples[,1]<20)
prob
n.sims <- 10000
my.samples <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
my.samples[i,] <- rmultinom(1,100,c(0.25,0.35,0.4))}
prob<-mean(my.samples[,3]>my.samples[,2])
prob
n.sims <- 10000
my.samples <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
my.samples[i,] <- rmultinom(1,100,c(0.25,0.35,0.4))}
prob<-mean(my.samples[,3]>my.samples[,2])
prob
n.sims <- 10000
my.samples <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
my.samples[i,] <- rmultinom(1,100,c(0.25,0.35,0.4))}
prob<-mean(my.samples[,3]>my.samples[,2])
prob
n.sims <- 10000
my.samples <- matrix(NA,n.sims,3)
for (i in 1:n.sims){
my.samples[i,] <- rmultinom(1,100,c(0.25,0.35,0.4))}
prob<-mean(my.samples[,3]>my.samples[,2])
prob
mean(rmultinom(100,5, c(0.2, 0.5, 0.2))[2, ])
mean(rmultinom(100,5, c(0.2, 0.5, 0.2))[2, ])
mean(rmultinom(100,5, c(0.2, 0.5, 0.2))[2, ])
mean(rmultinom(100,5, c(0.2, 0.5, 0.2))[2, ])
mean(rmultinom(100,5, c(0.2, 0.5, 0.2))[2, ])
mean(rmultinom(100,5, c(0.2, 0.5, 0.2))[2, ])
mean(rmultinom(100,5, c(0.2, 0.5, 0.2))[2, ])
mean(rmultinom(100,5, c(0.2, 0.5, 0.2))[2, ])
mean(multinom(100, 5, c(0.3, 0.5, 0.2))[,2]
)
my.samples <- rmultinom(100, 5, c(0.3,0.5,0.2))
colMeans(my.samples)
mean(rmultinom(100, 5, c(0.3, 0.5, 0.2)) [2, ])
n.sims <- 100
my.samples <- rmultinom(n.sims, 5, prob = c( 0.3, 0.5, 0.2))
mean(my.samples[,2])
mean(rbinom(100,5,0.5))
mean(rbinom(100,5,0.5))
b_patients <-rbinom(10000,100,0.35)
placebo_patients <-rbinom(10000,100,0.4)
estimate_2 <- mean(placebo_patients > b_patients)
estimate_2
b_patients <-rbinom(10000,100,0.35)
placebo_patients <-rbinom(10000,100,0.4)
estimate_2 <- mean(placebo_patients > b_patients)
estimate_2
b_patients <-rbinom(10000,100,0.35)
placebo_patients <-rbinom(10000,100,0.4)
estimate_2 <- mean(placebo_patients > b_patients)
estimate_2
n_simulations <- 100000
treatment_a_count <- replicate(n_simulations, sum(sample(c("A", "B", "P"), size = 100, replace = TRUE, prob = c(0.25, 0.35, 0.40)) == "A"))
prob_less_than_20 <- mean(treatment_a_count < 20)
prob_less_than_20
n_simulations <- 100000
treatment_a_count <- replicate(n_simulations, sum(sample(c("A", "B", "P"), size = 100, replace = TRUE, prob = c(0.25, 0.35, 0.40)) == "A"))
prob_less_than_20 <- mean(treatment_a_count < 20)
prob_less_than_20
n_simulations <- 100000
treatment_a_count <- replicate(n_simulations, sum(sample(c("A", "B", "P"), size = 100, replace = TRUE, prob = c(0.25, 0.35, 0.40)) == "A"))
prob_less_than_20 <- mean(treatment_a_count < 20)
prob_less_than_20
prob_placebo_gt_b
n_simulations <- 100000
results <- replicate(n_simulations, {
assignments <- sample(c("A", "B", "P"), size = 100, replace = TRUE, prob = c(0.25, 0.35, 0.40))
count_b <- sum(assignments == "B")
count_p <- sum(assignments == "P")
count_p > count_b
})
prob_placebo_gt_b <- mean(results)
prob_placebo_gt_b
n_simulations <- 100000
results <- replicate(n_simulations, {
assignments <- sample(c("A", "B", "P"), size = 100, replace = TRUE, prob = c(0.25, 0.35, 0.40))
count_b <- sum(assignments == "B")
count_p <- sum(assignments == "P")
count_p > count_b
})
prob_placebo_gt_b <- mean(results)
prob_placebo_gt_b
n.sims <- 10000
number.A <- rep(NA,n.sims)
for (i in 1:n.sims){
my.data <- sample(c("A","B","P"),100,replace=TRUE,prob=c(0.25,0.35,0.4))
number.A[i] <- sum(my.data=="A")
}
mean(number.A < 20)
n.sims <- 10000
number.A <- rep(NA,n.sims)
number.B <- rep(NA,n.sims)
number.P <- rep(NA,n.sims)
for (i in 1:n.sims){
my.data <- sample(c("A","B","P"),100,replace=TRUE,prob=c(0.25,0.35,0.4))
number.A[i] <- sum(my.data=="A")
number.B[i] <- sum(my.data=="B")
number.P[i] <- sum(my.data=="P")
}
mean(number.P > number.B)
Placebo <- 40
Treatment_B <- 35
maxval <- 100
prob <- 0
for (i in 0:maxval) {
prob <- prob + dpois(i, Placebo) * ppois(i-1, Treatment_B)
}
prob
n.sims <- 10000
n.patients <- 100
prob <- c(0.25, 0.35, 0.40)
count_less_than_20 <- 0
for (i in 1:n.sims) {
sim <- rmultinom(1, size = n.patients, prob = prob)
if (sim[1, 1] < 20) {
count_less_than_20 <- count_less_than_20 + 1
}
}
prob_less_than_20 <- count_less_than_20 / n.sims
(prob_less_than_20, 2)
n.sims <- 10000
n.patients <- 100
prob <- c(0.25, 0.35, 0.40)
count_less_than_20 <- 0
for (i in 1:n.sims) {
sim <- rmultinom(1, size = n.patients, prob = prob)
if (sim[1, 1] < 20) {
count_less_than_20 <- count_less_than_20 + 1
}
}
prob_less_than_20 <- count_less_than_20 / n.sims
round(prob_less_than_20, 2)
n.sims <- 10000
n.patients <- 100
prob <- c(0.25, 0.35, 0.40)
count_less_than_20 <- 0
for (i in 1:n.sims) {
sim <- rmultinom(1, size = n.patients, prob = prob)
if (sim[1, 1] < 20) {
count_less_than_20 <- count_less_than_20 + 1
}
}
prob_less_than_20 <- count_less_than_20 / n.sims
round(prob_less_than_20, 4)
n.sims <- 10000
n.patients <- 100
prob <- c(0.25, 0.35, 0.40)
count_placebo_gt_b <- 0
for (i in 1:n.sims) {
sim <- rmultinom(1, size = n.patients, prob = prob)
# sim[3,1] is Placebo count, sim[2,1] is Treatment B count
if (sim[3, 1] > sim[2, 1]) {
count_placebo_gt_b <- count_placebo_gt_b + 1
}
}
prob_placebo_gt_b <- count_placebo_gt_b / n.sims
(prob_placebo_gt_b, 2)
n.sims <- 10000
n.patients <- 100
prob <- c(0.25, 0.35, 0.40)
count_placebo_gt_b <- 0
for (i in 1:n.sims) {
sim <- rmultinom(1, size = n.patients, prob = prob)
# sim[3,1] is Placebo count, sim[2,1] is Treatment B count
if (sim[3, 1] > sim[2, 1]) {
count_placebo_gt_b <- count_placebo_gt_b + 1
}
}
prob_placebo_gt_b <- count_placebo_gt_b / n.sims
round(prob_placebo_gt_b, 2)
n.sims <- 10000
n.patients <- 100
prob <- c(0.25, 0.35, 0.40)
count_placebo_gt_b <- 0
for (i in 1:n.sims) {
sim <- rmultinom(1, size = n.patients, prob = prob)
# sim[3,1] is Placebo count, sim[2,1] is Treatment B count
if (sim[3, 1] > sim[2, 1]) {
count_placebo_gt_b <- count_placebo_gt_b + 1
}
}
prob_placebo_gt_b <- count_placebo_gt_b / n.sims
round(prob_placebo_gt_b, 2)
