cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
# Project 2025 brackets, married filing jointly
if (tinc <= 168000) {
ftax <- 0.15 * tinc
} else {
ftax <- 0.15 * 168000 + 0.3 * (tinc - 168000)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
ded <- 29200
inc <- 200000
tinc <- inc - ded
# Current 2024 brackets, married filing jointly
if (tinc <= 23200) {
ftax <- 0.1 * tinc
} else if (tinc <= 94300) {
ftax <- 0.1* 23200 + 0.12 * (tinc - 23200)
} else if (tinc <= 201050) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (tinc - 94300)
} else if (tinc <= 383900) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (tinc - 201050)
} else if (tinc <= 487450) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (tinc - 383900)
} else if (tinc <= 731200) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (tinc - 487450)
} else {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (731200 - 487450) +
0.37 * (tinc - 731200)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
# Project 2025 brackets, married filing jointly
if (tinc <= 168000) {
ftax <- 0.15 * tinc
} else {
ftax <- 0.15 * 168000 + 0.3 * (tinc - 168000)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
ded <- 29200
inc <- 180000
tinc <- inc - ded
# Current 2024 brackets, married filing jointly
if (tinc <= 23200) {
ftax <- 0.1 * tinc
} else if (tinc <= 94300) {
ftax <- 0.1* 23200 + 0.12 * (tinc - 23200)
} else if (tinc <= 201050) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (tinc - 94300)
} else if (tinc <= 383900) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (tinc - 201050)
} else if (tinc <= 487450) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (tinc - 383900)
} else if (tinc <= 731200) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (tinc - 487450)
} else {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (731200 - 487450) +
0.37 * (tinc - 731200)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
# Project 2025 brackets, married filing jointly
if (tinc <= 168000) {
ftax <- 0.15 * tinc
} else {
ftax <- 0.15 * 168000 + 0.3 * (tinc - 168000)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
ded <- 29200
inc <- 170000
tinc <- inc - ded
# Current 2024 brackets, married filing jointly
if (tinc <= 23200) {
ftax <- 0.1 * tinc
} else if (tinc <= 94300) {
ftax <- 0.1* 23200 + 0.12 * (tinc - 23200)
} else if (tinc <= 201050) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (tinc - 94300)
} else if (tinc <= 383900) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (tinc - 201050)
} else if (tinc <= 487450) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (tinc - 383900)
} else if (tinc <= 731200) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (tinc - 487450)
} else {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (731200 - 487450) +
0.37 * (tinc - 731200)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
# Project 2025 brackets, married filing jointly
if (tinc <= 168000) {
ftax <- 0.15 * tinc
} else {
ftax <- 0.15 * 168000 + 0.3 * (tinc - 168000)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
ded <- 29200
inc <- 170000
tinc <- inc - ded
# Current 2024 brackets, married filing jointly
if (tinc <= 23200) {
ftax <- 0.1 * tinc
} else if (tinc <= 94300) {
ftax <- 0.1* 23200 + 0.12 * (tinc - 23200)
} else if (tinc <= 201050) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (tinc - 94300)
} else if (tinc <= 383900) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (tinc - 201050)
} else if (tinc <= 487450) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (tinc - 383900)
} else if (tinc <= 731200) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (tinc - 487450)
} else {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (731200 - 487450) +
0.37 * (tinc - 731200)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
# Project 2025 brackets, married filing jointly
if (tinc <= 335000) {
ftax <- 0.15 * tinc
} else {
ftax <- 0.15 * 168000 + 0.3 * (tinc - 168000)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
ded <- 29200
inc <- 170000
tinc <- inc - ded
# Current 2024 brackets, married filing jointly
if (tinc <= 23200) {
ftax <- 0.1 * tinc
} else if (tinc <= 94300) {
ftax <- 0.1* 23200 + 0.12 * (tinc - 23200)
} else if (tinc <= 201050) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (tinc - 94300)
} else if (tinc <= 383900) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (tinc - 201050)
} else if (tinc <= 487450) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (tinc - 383900)
} else if (tinc <= 731200) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (tinc - 487450)
} else {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (731200 - 487450) +
0.37 * (tinc - 731200)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
# Project 2025 brackets, married filing jointly
cutoff <- 330000
if (tinc <= cutoff) {
ftax <- 0.15 * tinc
} else {
ftax <- 0.15 * cutoff + 0.3 * (tinc - cutoff)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
ded <- 29200
inc <- 160000
tinc <- inc - ded
# Current 2024 brackets, married filing jointly
if (tinc <= 23200) {
ftax <- 0.1 * tinc
} else if (tinc <= 94300) {
ftax <- 0.1* 23200 + 0.12 * (tinc - 23200)
} else if (tinc <= 201050) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (tinc - 94300)
} else if (tinc <= 383900) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (tinc - 201050)
} else if (tinc <= 487450) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (tinc - 383900)
} else if (tinc <= 731200) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (tinc - 487450)
} else {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (731200 - 487450) +
0.37 * (tinc - 731200)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
# Project 2025 brackets, married filing jointly
cutoff <- 330000
if (tinc <= cutoff) {
ftax <- 0.15 * tinc
} else {
ftax <- 0.15 * cutoff + 0.3 * (tinc - cutoff)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
ded <- 29200
inc <- 180000
tinc <- inc - ded
# Current 2024 brackets, married filing jointly
if (tinc <= 23200) {
ftax <- 0.1 * tinc
} else if (tinc <= 94300) {
ftax <- 0.1* 23200 + 0.12 * (tinc - 23200)
} else if (tinc <= 201050) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (tinc - 94300)
} else if (tinc <= 383900) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (tinc - 201050)
} else if (tinc <= 487450) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (tinc - 383900)
} else if (tinc <= 731200) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (tinc - 487450)
} else {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (731200 - 487450) +
0.37 * (tinc - 731200)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
# Project 2025 brackets, married filing jointly
cutoff <- 330000
if (tinc <= cutoff) {
ftax <- 0.15 * tinc
} else {
ftax <- 0.15 * cutoff + 0.3 * (tinc - cutoff)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
ded <- 29200
inc <- 100000
tinc <- inc - ded
# Current 2024 brackets, married filing jointly
if (tinc <= 23200) {
ftax <- 0.1 * tinc
} else if (tinc <= 94300) {
ftax <- 0.1* 23200 + 0.12 * (tinc - 23200)
} else if (tinc <= 201050) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (tinc - 94300)
} else if (tinc <= 383900) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (tinc - 201050)
} else if (tinc <= 487450) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (tinc - 383900)
} else if (tinc <= 731200) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (tinc - 487450)
} else {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (731200 - 487450) +
0.37 * (tinc - 731200)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
# Project 2025 brackets, married filing jointly
cutoff <- 330000
if (tinc <= cutoff) {
ftax <- 0.15 * tinc
} else {
ftax <- 0.15 * cutoff + 0.3 * (tinc - cutoff)
}
cat(paste0("On an income of $", inc, ", filing jointly, you would pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
ded <- 29200
inc <- 250000
tinc <- inc - ded
# Current 2024 brackets, married filing jointly
if (tinc <= 23200) {
ftax <- 0.1 * tinc
} else if (tinc <= 94300) {
ftax <- 0.1* 23200 + 0.12 * (tinc - 23200)
} else if (tinc <= 201050) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (tinc - 94300)
} else if (tinc <= 383900) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (tinc - 201050)
} else if (tinc <= 487450) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (tinc - 383900)
} else if (tinc <= 731200) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (tinc - 487450)
} else {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (731200 - 487450) +
0.37 * (tinc - 731200)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
# Project 2025 brackets, married filing jointly
cutoff <- 330000
if (tinc <= cutoff) {
ftax <- 0.15 * tinc
} else {
ftax <- 0.15 * cutoff + 0.3 * (tinc - cutoff)
}
cat(paste0("On an income of $", inc, ", filing jointly, you would pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
ded <- 29200
inc <- 300000
tinc <- inc - ded
# Current 2024 brackets, married filing jointly
if (tinc <= 23200) {
ftax <- 0.1 * tinc
} else if (tinc <= 94300) {
ftax <- 0.1* 23200 + 0.12 * (tinc - 23200)
} else if (tinc <= 201050) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (tinc - 94300)
} else if (tinc <= 383900) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (tinc - 201050)
} else if (tinc <= 487450) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (tinc - 383900)
} else if (tinc <= 731200) {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (tinc - 487450)
} else {
ftax <- 0.1 * 23200 + 0.12 * (94300 - 23200) + 0.22 * (201050 - 94300) +
0.24 * (383900 - 201050) + 0.32 * (487450 - 383900) + 0.35 * (731200 - 487450) +
0.37 * (tinc - 731200)
}
cat(paste0("On an income of $", inc, ", filing jointly, you will pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
# Project 2025 brackets, married filing jointly
cutoff <- 330000
if (tinc <= cutoff) {
ftax <- 0.15 * tinc
} else {
ftax <- 0.15 * cutoff + 0.3 * (tinc - cutoff)
}
cat(paste0("On an income of $", inc, ", filing jointly, you would pay $", round(ftax, 0),
" in federal taxes, for an effective tax rate of ", round(ftax / inc * 100, 1), "%."))
1-pbinom(56, 100, .5)
1-pbinom(58, 100, .5)
1-pbinom(58, 100, .5)
?crossprod
setwd("~/research/global_gp")
results <- readRDS("objects/global.RDS")
quantile(results$paramSamples$beta, .025)
quantile(results$paramSamples$beta, .975)
hist(results$paramSamples$beta)
mean(results$paramSamples$beta)
median(results$paramSamples$beta)
plot(results$paramSamples$beta)
plot(results$paramSamples$beta, type='l')
plot(results$paramSamples$sigf2, type='l')
mean(results$paramSamples$sigf2)
mean(results$paramSamples$thf)
quantile(results$paramSamples$thf, .025)
quantile(results$paramSamples$thf, .975)
quantile(results$paramSamples$thf, c(.1, .9))
quantile(results$paramSamples$thf, c(.15, .85))
quantile(results$paramSamples$thf, c(.2, .8))
quantile(results$paramSamples$thf, c(.25, .75))
quantile(results$paramSamples$sigf2, c(.25, .75))
quantile(results$paramSamples$sigf2, c(.35, .65))
quantile(results$paramSamples$sigf2, c(.3, .7))
hist(results$paramSamples$thf)
hist(results$paramSamples$sigf2)
hist(results$paramSamples$sigf2, breaks=40)
plot(results$paramSamples$thf, type='l')
plot(results$paramSamples$tau2, type='l')
length(results$predSamples)
dim(results$predSamples)
length(results$preds)
dim(results$preds)
results$preds
results$preds[2,]
load("data/test.RData")
test$Y
sd(test$Y)
sd(results$preds[2,])
test$Y[1:5]
results$preds[2,1:5]
mean((results$preds[2,] - test$Y)^2)
sqrt(mean((results$preds[2,] - test$Y)^2))
mean(abs((results$preds[2,] - test$Y)^2))
mean(abs((results$preds[2,] - test$Y)))
quantile(results$paramSamples$beta, c(.025, .975))
quantile(results$paramSamples$beta, c(.2, .8))
quantile(results$paramSamples$beta, c(.15, .85))
setwd("~/research/global_gp")
load("data/train.RData")
load("data/test.RData")
load("data/theta.RData")
source("other_functions/helper_functions.R")
d.max <- max(iDist(train$U))
r <- 2
n <- nrow(train$X)
library(spBayes)
d.max <- max(iDist(train$U))
r <- 2
n <- nrow(train$X)
nTest <- nrow(test$X)
priors <- list("phi.Unif"=list(rep(3/(0.75*d.max), r), rep(3/(0.001*d.max), r)),
"sigma.sq.IG"=list(rep(2, r), rep(1, r)),
"tau.sq.IG"=c(2, 1))
starting <- list("phi"=rep(3/(0.1*d.max), r), "sigma.sq"=rep(1, r), "tau.sq"=1)
tuning <- list("phi"=rep(0.1, r), "sigma.sq"=rep(0.05, r), "tau.sq"=0.1)
n.samples <- 500
m.3 <- spSVC(train$Y[1:n,] ~ train$X - 1, coords=train$U,
starting=starting, svc.cols=c(1,2),
tuning=tuning, priors=priors, cov.model="exponential",
n.samples=n.samples, n.report=5000, n.omp.threads=4)
m.3 <- spRecover(m.3, start=floor(0.5*n.samples), thin=2,
n.omp.threads=4, verbose=FALSE)
STest <- nrow(test$Z)
abs_error <- cvg <- width <- scores <- crps <- numeric(STest)
a <- .05
for (i in 1:STest) {
truth <- test$Y[(nTest*(i-1)+1):(nTest*i), ]
m.3.pred <- spPredict(m.3, pred.covars=test$X,
pred.coords=test$U + rnorm(50, 0, 0.0001), thin=10,
joint=TRUE, n.omp.threads=4, verbose=FALSE)
pred <- apply(m.3.pred$p.y.predictive.samples, 1, mean)
abs_error[i] <- mean(abs(truth - pred))
lower <- apply(m.3.pred$p.y.predictive.samples, 1, quantile, .025)
upper <- apply(m.3.pred$p.y.predictive.samples, 1, quantile, .975)
cvg[i] <- mean(lower < truth & upper > truth)
width[i] <- mean(upper - lower)
scores[i] <- mean((upper - lower) +
2/a * (lower - truth) * (truth < lower) +
2/a * (truth - upper) * (truth > upper))
predSamples <- t(m.3.pred$p.y.predictive.samples)
crps[i] <- mean(energy_score(truth, predSamples))
}
abs_error
cat(paste0("Mean absolute error: ", round(mean(abs_error), 3), "\n"))
cvg
cat(paste0("Mean coverage: ", round(mean(cvg), 3), "\n"))
width
cat(paste0("Mean width: ", round(mean(width), 3), "\n"))
scores
cat(paste0("Mean interval score: ", round(mean(scores), 3), "\n"))
crps
cat(paste0("Mean CRPS: ", round(mean(crps), 3), "\n"))
setwd("~/research/global_gp")
library(spBayes)
load("data/train.RData")
load("data/test.RData")
load("data/theta.RData")
source("other_functions/helper_functions.R")
d.max <- max(iDist(train$U))
r <- 2
n <- nrow(train$X)
nTest <- nrow(test$X)
priors <- list("phi.Unif"=list(rep(3/(0.75*d.max), r), rep(3/(0.001*d.max), r)),
"sigma.sq.IG"=list(rep(2, r), rep(1, r)),
"tau.sq.IG"=c(2, 1))
starting <- list("phi"=rep(3/(0.1*d.max), r), "sigma.sq"=rep(1, r), "tau.sq"=1)
tuning <- list("phi"=rep(0.1, r), "sigma.sq"=rep(0.05, r), "tau.sq"=0.1)
n.samples <- 500
m.3 <- spSVC(train$Y[1:n,] ~ train$X - 1, coords=train$U,
starting=starting, svc.cols=c(1,2),
tuning=tuning, priors=priors, cov.model="exponential",
n.samples=n.samples, n.report=5000, n.omp.threads=4)
m.3 <- spRecover(m.3, start=floor(0.5*n.samples), thin=2,
n.omp.threads=4, verbose=FALSE)
STest <- nrow(test$Z)
rmse <- cvg <- width <- scores <- crps <- numeric(STest)
a <- .05
for (i in 1:STest) {
truth <- test$Y[(nTest*(i-1)+1):(nTest*i), ]
m.3.pred <- spPredict(m.3, pred.covars=test$X,
pred.coords=test$U + rnorm(50, 0, 0.0001), thin=10,
joint=TRUE, n.omp.threads=4, verbose=FALSE)
pred <- apply(m.3.pred$p.y.predictive.samples, 1, mean)
rmse[i] <- sqrt(mean((truth - pred)^2))
lower <- apply(m.3.pred$p.y.predictive.samples, 1, quantile, .025)
upper <- apply(m.3.pred$p.y.predictive.samples, 1, quantile, .975)
cvg[i] <- mean(lower < truth & upper > truth)
width[i] <- mean(upper - lower)
scores[i] <- mean((upper - lower) +
2/a * (lower - truth) * (truth < lower) +
2/a * (truth - upper) * (truth > upper))
predSamples <- t(m.3.pred$p.y.predictive.samples)
crps[i] <- mean(energy_score(truth, predSamples))
}
rmse
cat(paste0("Root MS error: ", round(mean(rmse), 3), "\n"))
cvg
cat(paste0("Mean coverage: ", round(mean(cvg), 3), "\n"))
width
cat(paste0("Mean width: ", round(mean(width), 3), "\n"))
scores
cat(paste0("Mean interval score: ", round(mean(scores), 3), "\n"))
crps
cat(paste0("Mean CRPS: ", round(mean(crps), 3), "\n"))
